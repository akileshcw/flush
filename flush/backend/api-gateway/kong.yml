_format_version: "1.1"

services:
  - name: auth-service
    url: http://auth-service:3000
    routes:
      - name: auth-route
        paths:
          - /auth
        strip_path: true
    plugins: [] # No authentication for auth service

  - name: patient-service
    url: http://patient-service:3001
    routes:
      - name: patient-route
        paths:
          - /patients
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
          secret: "your_jwt_secret"
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - patients

  - name: appointment-service
    url: http://appointment-service:3002
    routes:
      - name: appointment-route
        paths:
          - /appointments
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - appointments

  - name: doctor-service
    url: http://doctor-service:3003
    routes:
      - name: doctor-route
        paths:
          - /doctors
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - doctors

  - name: patient-portal-service
    url: http://patient-portal-service:3004
    routes:
      - name: patient-portal-route
        paths:
          - /patient-portal
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - patientPortal

  - name: notification-service
    url: http://notification-service:3005
    routes:
      - name: notification-route
        paths:
          - /notifications
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - notifications

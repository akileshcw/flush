_format_version: "2.1"

#Consumers to track the token
consumers:
  - username: "auth-service-consumer"
    jwt_secrets:
      - key: "auth-service"
        algorithm: "HS256"
        secret: "your_jwt_secret"
    acls:
      - group: "doctors"
      - group: "staffs"

  # - username: "auth-service-consumer-2"
  #   jwt_secrets:
  #     - key: "better-auth-frontend"
  #       algorithm: "ES256"
  #       secret: "your_jwt_secret"
  #   acls:
  #     - group: "doctors"

#List of all services
services:
  - name: auth-service
    url: http://auth-service:3000
    routes:
      - name: auth-route
        paths:
          - /auth
        strip_path: true
    plugins: []

  - name: patient-service
    url: http://patient-service:3001
    routes:
      - name: patient-route
        paths:
          - /patients
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - patients

  - name: appointment-service
    url: http://appointment-service:3002
    routes:
      - name: appointment-route
        paths:
          - /appointments
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - appointments

  - name: doctor-service
    url: http://doctor-service:3003
    routes:
      - name: doctor-route
        paths:
          - /doctors
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - doctors

  - name: patient-portal-service
    url: http://patient-portal-service:3004
    routes:
      - name: patient-portal-route
        paths:
          - /patient-portal
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - patientPortal

  - name: notification-service
    url: http://notification-service:3005
    routes:
      - name: notification-route
        paths:
          - /notifications
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - notifications

  - name: branch-service
    url: http://branch-service:3006
    routes:
      - name: branch-route
        paths:
          - /branch
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - branch

  - name: equipment-service
    url: http://equipment-service:3007
    routes:
      - name: equipment-route
        paths:
          - /equipment
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - equipment

  - name: report-service
    url: http://report-service:3008
    routes:
      - name: report-route
        paths:
          - /report
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - report

  - name: feedback-service
    url: http://feedback-service:3009
    routes:
      - name: feedback-route
        paths:
          - /feedback
        strip_path: true
    plugins:
      - name: jwt
        config:
          key_claim_name: "iss"
          secret_is_base64: false
          claims_to_verify: ["exp"]
      - name: acl
        config:
          hide_groups_header: true
          allow:
            - feedback
